sudo: required
services:
- docker
language: node_js
node_js:
  - "6"
script:
- yarn install && npm test
- docker run --rm --privileged multiarch/qemu-user-static:register --reset
- docker-compose version && docker-compose build
- |
  if [ "$TRAVIS_BRANCH" == "master" ] && [ "$TRAVIS_PULL_REQUEST" == "false" ]; then
    docker login -u="$DOCKER_USER" -p="$DOCKER_PASS"
    docker-compose push
  fi
env:
  global:
  - secure: C4QeduSCPsH5sayleRVq0Mn9wy6dYc+LXtVclYZJYf1ovPiaL3vMMFC1qnMMNS8wzkyaPmI4VV0dPbdJpfn4cn0yAvYhVn3qbLGtAM7xMagI6o16e+vd3fnqhXkZc/vz2njXUXBgYJSJxhX2rB1lkOMz2wAGI67AdODd8c31oxjpGPwnDS0LGdbG2JnVU8GEML9HVtR/W8u/2xOO1Eu2Tb83YVcxH7LvJVDFRuJscNwqR8qiOgb3NFlR3eRrMdOkGIylHKstkG9SEdstxmnZeI/BX0wauEiAUF5C9IL5XLxUiwblZ1hJ5GNCussW1gx3RRZ9WW+oJtjNe7EJ57Zo4OhPnup+Q9cgvG8349efuLwWNsMY/mefquezoQyMob6S8oR1yPCsVxYrK4JrWgBZe+f9JO4LSC+2r6hbN2WxTmkruf0wSBrAK7J2Mdu3vqgX+o6s1A6CjdFzdqS8t90/1tiNlSrTNiWgtkjoe70+vhN7HfI2Q3qbcUSH+RVj/4LE1rN0mu/6Fjxukn44FPd3lZTcv+QId3NwE07iWZxCPwo/pB5mYpXNoGGb9nshHzyb/ygV5MxRV14ZlunllQ9MCidNCaeHfL5PJAbG9Pnm5FSK+fuLaq3cK0iS2o0rCznJm743CHKb7FjTSNDUgSwJ3ne0jyu31yo0lwndOj96k/Y=
  - secure: UcY8L2rafHhsJDJZvIYtPkIfK2bdzgEvm2Qf4sWk3UcCXXIzhztJkdke6d0gG2HJayIEZ1KHSN44Ki9FPhjKf72bln8wMSkLdMqzaE08x6rI7XiEtxZBR2Yss/2QOdkzZf3OfCgTaXD2G+p813gSY1DCJnR6VqqncLx8Gw2w/2OtJJ5IpB7UY8CVYVau9wChshmnCPFRjIb6P4SWDMOuGysb+WShvQMneF9xQr0rReLed9avhT9Sf1HMcYKi2oMLR7j/HUnoQhMGSZEzGDnP18+/RHpYM33U1m0BIeOs6/ZkurNiUJVnD/tn6uXEhJIl4VN4qCLagz831ycMjMcgaJzA2S51+JPhAyUzIWdnne9TMDx49Je91JB/E/e6+M4X651vHg5SAe9rE3aTgR7MvnhqcgyZCH9npM1hlZVv1mtfLoJFtb6XMfjHqhfYU3qgJhpmvgUNUb4v5/8q5AKiQTUWLhabN1ZdagivRmf+DV4yYbl61lngpLuKnYOK/EMQn0DgQapZ1UqbhpM/uuUEqM/F7aP4LlW0PFZpSYo1NND0558tV1MvCJq+oORr7IYATO5c1bueUJKSZa4EWxwvDx7E4dcpBQewOi6gUs/cb4kMVLTjWTiesbgXdh5QhRs22Mc4sS6KdYcB7W7u99uJBb8/ccvQ/OeCrfGMcnFE4Pg=
before_install:
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/1.13.0/docker-compose-`uname -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
- sudo apt-get update
- sudo apt-get -y -o Dpkg::Options::="--force-confnew" install docker-ce
